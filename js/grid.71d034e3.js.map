{"version":3,"file":"js/grid.71d034e3.js","mappings":"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","sources":["webpack://webgl_polygon/./src/apps/grid/View.vue","webpack://webgl_polygon/./src/apps/grid/grid.frag","webpack://webgl_polygon/./src/apps/grid/grid.vert","webpack://webgl_polygon/./src/lib/math/Angle.ts","webpack://webgl_polygon/./src/lib/misc/AcceleratedStepper.ts","webpack://webgl_polygon/./src/lib/misc/DataUrlDownloader.ts","webpack://webgl_polygon/./src/lib/misc/EventWaiter.ts","webpack://webgl_polygon/./src/apps/grid/View.vue?cf68","webpack://webgl_polygon/./src/apps/grid/View.vue?8e52","webpack://webgl_polygon/./src/apps/grid/View.vue?6b58","webpack://webgl_polygon/./src/components/Viewport.vue","webpack://webgl_polygon/./src/components/Viewport.vue?76f1","webpack://webgl_polygon/./src/components/Viewport.vue?a713","webpack://webgl_polygon/./src/components/Viewport.vue?3ed8","webpack://webgl_polygon/./src/lib/misc/Throw.ts","webpack://webgl_polygon/./src/lib/render/ShaderProgram.ts"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('div',{staticClass:\"flex\"},[_c('Viewport',{ref:\"view\",attrs:{\"width\":_vm.width,\"height\":_vm.height,\"preserveDrawingBuffer\":\"true\"},on:{\"context-ready\":_vm.OnContextReady},nativeOn:{\"wheel\":function($event){$event.preventDefault();return _vm.OnWheel($event.deltaY, $event.ctrlKey, $event.altKey)},\"mousemove\":function($event){return _vm.OnMouseMove($event.buttons, $event.ctrlKey, $event.movementX, $event.movementY)},\"drop\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.OnLoadImage($event.dataTransfer.files[0])},\"dragover\":function($event){$event.stopPropagation();$event.preventDefault();return (() => 0).apply(null, arguments)}}}),_c('aside',[_c('fa-icon',{staticClass:\"panelHelpTrigger\",attrs:{\"icon\":\"question-circle\"}}),_c('div',{staticClass:\"panelHelpContent\"},[_c('ul',[_c('li',[_c('fa-icon',{attrs:{\"icon\":\"mouse\"}}),_vm._v(\"  \"),_c('span',{staticClass:\"accent\"},[_vm._v(\"LMB\")]),_vm._v(\" - move grid \")],1),_c('li',[_c('fa-icon',{attrs:{\"icon\":\"mouse\"}}),_vm._v(\"  \"),_c('span',{staticClass:\"accent\"},[_vm._v(\"WHEEL\")]),_vm._v(\" - scale grid \")],1),_vm._m(0),_c('li',[_c('fa-icon',{attrs:{\"icon\":\"mouse\"}}),_vm._v(\"  \"),_c('span',{staticClass:\"accent\"},[_vm._v(\"WHEEL\")]),_vm._v(\" + ALT - rotate image \")],1)])]),_c('table',[_vm._m(1),_c('tbody',[_c('tr',[_c('td',[_vm._v(\"Offset\")]),_c('td',[_vm._v(_vm._s(_vm.gridState[0]))]),_c('td',[_vm._v(_vm._s(_vm.gridState[1]))])]),_c('tr',[_c('td',[_vm._v(\"Scale\")]),_c('td',{attrs:{\"colspan\":\"2\"}},[_vm._v(_vm._s(_vm.GridScale.toFixed(4)))])])])]),_c('table',[_vm._m(2),_c('tbody',[_c('tr',[_c('td',[_vm._v(\"Offset\")]),_c('td',[_vm._v(_vm._s(_vm.imageState[0].toFixed(1)))]),_c('td',[_vm._v(_vm._s(_vm.imageState[1].toFixed(1)))])]),_c('tr',[_c('td',[_vm._v(\"Angle\")]),_c('td',{attrs:{\"colspan\":\"2\"}},[_vm._v(_vm._s(_vm.ImageAngleDegrees.toFixed(1)))])]),_c('tr',[_c('td',[_vm._v(\"Scale\")]),_c('td',{attrs:{\"colspan\":\"2\"}},[_vm._v(_vm._s(_vm.ImageScale.toFixed(4)))])])])]),_c('div',{staticClass:\"actions\"},[_c('div',{staticClass:\"actions-group\"},[_c('button',{staticClass:\"rightMargin\",attrs:{\"disabled\":_vm.NoImage},on:{\"click\":_vm.CenterImage}},[_vm._v(\"Center image\")]),_c('button',{on:{\"click\":_vm.Preview}},[_vm._v(\"Save\")])]),_c('button',{attrs:{\"disabled\":_vm.NoImage},on:{\"click\":_vm.AlignToGrid}},[_vm._v(\"Align to grid\")])])],1)],1)\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('li',[_vm._v(\" Image controlled in the same way by holding \"),_c('span',{staticClass:\"accent\"},[_vm._v(\"CTRL\")])])\n},function (){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('thead',[_c('tr',[_c('th',{attrs:{\"colspan\":\"3\"}},[_vm._v(\"Grid\")])])])\n},function (){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('thead',[_c('tr',[_c('th',{attrs:{\"colspan\":\"3\"}},[_vm._v(\"Image\")])])])\n}]\n\nexport { render, staticRenderFns }","export default \"#version 300 es\\n\\nprecision mediump float;\\n\\nuniform vec3 u_grid;\\nuniform vec4 u_image;\\nuniform sampler2D u_target;\\n\\nout vec4 outColor;\\n\\nbool CellBorder(float x)\\n{\\n  return mod(x, u_grid.z) == 1.f;\\n}\\nvoid main() \\n{\\n  vec2 p = gl_FragCoord.xy - 0.5f;\\n  ivec2 textSize = textureSize(u_target, 0);\\n  if (CellBorder(u_grid.x - p.x) || CellBorder(u_grid.y - p.y))\\n  {\\n    outColor = vec4(0, 0, 0, 1);\\n  } \\n  else if (textSize != ivec2(1, 1))\\n  {\\n    float aspect = float(textSize.x) / float(textSize.y);\\n\\n    float s = sin(u_image.z);\\n    float c = cos(u_image.z);\\n\\n    mat2 rot = mat2(c, -s, s, c);\\n    mat2 scale = mat2(aspect, 0, 0, 1);\\n    mat2 scaleInv = mat2(1.0 / aspect, 0, 0, 1);\\n\\n    vec2 texPos = p / vec2(textSize.x, textSize.y) / u_image.w - 0.5 - u_image.xy / u_image.w / vec2(textSize.x, textSize.y);\\n    texPos = scaleInv * rot * scale * texPos ;\\n    texPos += 0.5;\\n\\n    texPos.y = 1.0 - texPos.y;\\n    \\n    if (texPos.x >= 0.f && texPos.x <= 1.f && texPos.y >= 0.f && texPos.y <= 1.f)\\n    {\\n      outColor = texture(u_target, texPos);     \\n    }\\n    else\\n    {\\n      outColor = vec4(1);\\n    }\\n  }\\n  else\\n  {\\n    outColor = vec4(1);\\n  }\\n}\"","export default \"#version 300 es\\nin vec2 a_vertex;\\n\\nvoid main() \\n{\\n  gl_Position = vec4(a_vertex, 0, 1);\\n}\"","import { Vec2 } from '../misc/Primitives';\n\nexport class Angle {\n  public static ToRadians(degree: number): number {\n    return (degree / 180) * Math.PI;\n  }\n\n  public static ToDegrees(rad: number) {\n    return (rad / Math.PI) * 180;\n  }\n\n  public static Vec0Pi(a0: Vec2, a1: Vec2, b0: Vec2, b1: Vec2): number {\n    const a: Vec2 = { X: a1.X - a0.X, Y: a1.Y - a0.Y };\n    const b: Vec2 = { X: b1.X - b0.X, Y: b1.Y - b0.Y };\n\n    const dotProduct: number = a.X * b.X + a.Y * b.Y;\n\n    const aMagnitude: number = Math.sqrt(a.X * a.X + a.Y * a.Y);\n    const bMagnitude: number = Math.sqrt(b.X * b.X + b.Y * b.Y);\n\n    return Math.acos(dotProduct / (aMagnitude * bMagnitude));\n  }\n}\n","export class AcceleratedStepper {\n  private step: number;\n  private prevActionTimestamp = 0;\n\n  constructor(\n    private readonly defaultStep: number,\n    private readonly upperBound: number,\n    private readonly acceleration: number,\n    private readonly resetTimeout: number\n  ) {\n    this.step = defaultStep;\n  }\n\n  public Step(): number {\n    if (this.NeedAccelerate) {\n      if (this.step + this.acceleration <= this.upperBound) {\n        this.step += this.acceleration;\n      }\n    } else {\n      this.step = this.defaultStep;\n    }\n\n    this.prevActionTimestamp = Date.now();\n\n    return this.step;\n  }\n\n  private get NeedAccelerate(): boolean {\n    return Date.now() - this.prevActionTimestamp <= this.resetTimeout;\n  }\n}\n","export function DataUrlDownloader(dataUrl: string, filename: string) {\n  const a = document.createElement('a');\n  a.href = dataUrl;\n  a.download = filename;\n  a.click();\n}\n","export async function EventWaiter<T extends keyof HTMLElementEventMap>(\n  target: EventTarget,\n  event: T\n) {\n  return new Promise(ok =>\n    target.addEventListener(event, ok, { once: true })\n  );\n}\n","\nimport { Component, Ref, Vue, Watch } from 'vue-property-decorator';\n\nimport FShader from './grid.frag';\nimport VShader from './grid.vert';\n\nimport Viewport from '@/components/Viewport.vue';\nimport { Angle } from '@/lib/math/Angle';\nimport { AcceleratedStepper } from '@/lib/misc/AcceleratedStepper';\nimport { DataUrlDownloader } from '@/lib/misc/DataUrlDownloader';\nimport { EventWaiter } from '@/lib/misc/EventWaiter';\nimport { ShaderProgram } from '@/lib/render/ShaderProgram';\n\n\ninterface Dimension {\n  width: number;\n  height: number;\n}\n\nenum StateComponent { X = 0, Y = 1 }\n\n@Component({\n  components: {\n    Viewport\n  }\n})\nexport default class Main extends Vue {\n  private app!: ShaderProgram;\n  private gl!: WebGL2RenderingContext;\n  private vao: WebGLVertexArrayObject | null = null;\n  private vbo: WebGLBuffer | null = null;\n  public gridState = [0, 0, 100];\n  public imageState = [0, 0, 0, 1];\n  public width = 800;\n  public height = 600;\n  private imgRealDimension: Dimension = { width: 0, height: 0 };\n  private scroll = new AcceleratedStepper(0.01, 0.7, 0.05, 25);\n  @Ref() private readonly view!: any;\n  public async mounted() {\n    this.FillWindow();\n\n    window.addEventListener('resize', () => this.FillWindow());\n\n    this.app = new ShaderProgram(this.gl);\n\n    this.app.Attach(this.gl.FRAGMENT_SHADER, FShader);\n    this.app.Attach(this.gl.VERTEX_SHADER, VShader);\n\n    this.app.Link();\n    this.app.Use();\n\n    this.SetupBackground();\n    this.SetupImage();\n\n    this.gl.disable(this.gl.DEPTH_TEST);\n\n    this.gl.clearColor(1, 1, 1, 1);\n    this.gl.clear(this.gl.COLOR_BUFFER_BIT);\n\n    this.app.SetUniform3fv('u_grid', this.gridState); // [offset_x, offset_y, cell_size_in_window_coords]\n    this.app.SetUniform4fv('u_image', this.imageState);\n\n    this.gl.bindVertexArray(this.vao);\n    window.requestAnimationFrame(() => this.Draw());\n  }\n  public beforeDestroy() {\n    console.log('unsubscribe from resize event');\n  }\n  public OnContextReady(ctx: WebGL2RenderingContext) { this.gl = ctx; }\n  private SetupBackground() {\n    const background = [\n      /*triangle 1*/-1, -1, 1, -1, 1, 1,\n     /* triangle 2*/1, 1, -1, 1, -1, -1\n    ];\n    this.vao = this.gl.createVertexArray();\n    this.vbo = this.gl.createBuffer();\n\n    this.gl.bindVertexArray(this.vao);\n\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.vbo);\n    this.gl.bufferData(this.gl.ARRAY_BUFFER, new Float32Array(background), this.gl.STATIC_DRAW);\n\n    const posLoc = this.app.GetAttributeLocation('a_vertex');\n    this.app.SetUniform1i('u_target', 0);\n\n    this.gl.enableVertexAttribArray(posLoc);\n    this.gl.vertexAttribPointer(posLoc, 2, this.gl.FLOAT, false, 0, 0);\n\n    this.gl.bindVertexArray(null);\n  }\n  private SetupImage() {\n    const texture = this.gl.createTexture();\n    this.gl.activeTexture(this.gl.TEXTURE0);\n    this.gl.bindTexture(this.gl.TEXTURE_2D, texture);\n\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_S, this.gl.CLAMP_TO_EDGE);\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_WRAP_T, this.gl.CLAMP_TO_EDGE);\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MIN_FILTER, this.gl.NEAREST);\n    this.gl.texParameteri(this.gl.TEXTURE_2D, this.gl.TEXTURE_MAG_FILTER, this.gl.NEAREST);\n  }\n  private Draw() {\n    this.gl.drawArrays(this.gl.TRIANGLES, 0, 6);\n    window.requestAnimationFrame(() => this.Draw());\n  }\n  public OnWheel(offset: number, ctrl: boolean, alt: boolean) {\n    if (ctrl)\n      this.OnImageScale(offset);\n    else if (alt)\n      this.OnImageRotate(offset);\n    else\n      this.OnGridScale(offset);\n  }\n  /**\n   * @param offsetX positive values for moving towards right\n   * @param offsetY positive values for moving towards top\n   */\n  public OnMouseMove(btn: number, ctrl: boolean, offsetX: number, offsetY: number) {\n    if (btn & 1) {\n      if (ctrl)\n        this.OnImageMove(offsetX, offsetY * -1);\n      else\n        this.OnGridMove(offsetX, offsetY * -1);\n    }\n  }\n  private OnGridScale(offset: number) {\n    const step = 1;\n    if (offset < 0)\n      this.GridScale = this.gridState[2] + step;\n    else if (this.gridState[2] > 10)\n      this.GridScale = this.gridState[2] - step;\n  }\n  private OnImageScale(offset: number) {\n    const step = this.scroll.Step();\n\n    if (offset < 0)\n      this.ImageScale = this.imageState[3] + step;\n    else if (this.ImageScale - step > 0.2)\n      this.ImageScale = this.imageState[3] - step;\n  }\n  private OnImageRotate(offset: number) {\n    const step = 2 * Math.PI / 360;\n    const clip = 2 * Math.PI;\n    if (offset > 0)\n      this.ImageAngle = (this.imageState[2] + step) % clip;\n    else if (this.imageState[2] < step)\n      this.ImageAngle = clip - (step - this.imageState[2]);\n    else\n      this.ImageAngle = this.imageState[2] - step;\n  }\n  private OnGridMove(offsetX: number, offsetY: number) {\n    this.$set(this.gridState, 0, this.gridState[0] + offsetX);\n    this.$set(this.gridState, 1, this.gridState[1] + offsetY);\n  }\n  private OnImageMove(offsetX: number, offsetY: number) {\n    this.ImageOffset = { x: this.imageState[0] + offsetX, y: this.imageState[1] + offsetY };\n  }\n  private set ImageOffset(offset: { x: number, y: number }) {\n    this.$set(this.imageState, 0, offset.x);\n    this.$set(this.imageState, 1, offset.y);\n  }\n  private get ImageOffset() { return { x: this.imageState[0], y: this.imageState[1] }; }\n  public set GridScale(val: number) { this.$set(this.gridState, 2, val); }\n  public get GridScale() { return this.gridState[2]; }\n  public set ImageScale(val: number) { this.$set(this.imageState, 3, val); }\n  public get ImageScale() { return this.imageState[3]; }\n  private get ImageAngle() { return this.imageState[2]; }\n  private set ImageAngle(angle: number) { this.$set(this.imageState, 2, angle); }\n  public get ImageAngleDegrees() { return Angle.ToDegrees(this.ImageAngle); }\n  private get ImageDimension(): Dimension {\n    return {\n      width: this.imgRealDimension.width * this.imageState[3],\n      height: this.imgRealDimension.height * this.imageState[3]\n    }\n  }\n\n  public get NoImage(): boolean { return this.imgRealDimension.width === 0 }\n\n  @Watch('gridState')\n  private OnGridUpdate() {\n    this.app.SetUniform3fv('u_grid', this.gridState); // [offset_x, offset_y, cell_size_in_window_coords]\n  }\n  @Watch('imageState')\n  private OnImageUpdate() {\n    this.app.SetUniform4fv('u_image', this.imageState);\n  }\n  public async OnLoadImage(blob: File) {\n    const img = new Image();\n    img.src = URL.createObjectURL(blob);\n    await EventWaiter(img, 'load');\n\n    this.imgRealDimension = { width: img.width, height: img.height };\n    this.ImageOffset = { x: 0, y: 0 };\n    this.ImageScale = this.AutoScale(img.width, img.height);\n    this.gl.texImage2D(this.gl.TEXTURE_2D, 0, this.gl.RGBA, this.gl.RGBA, this.gl.UNSIGNED_BYTE, img);\n  }\n  private AutoScale(width: number, height: number) {\n    return width > height ? this.width / width : this.height / height;\n  }\n  private FillWindow() {\n    this.width = window.innerWidth;\n    this.height = window.innerHeight;\n  }\n  public CenterImage() {\n    this.ImageOffset = { x: this.width / 2 - this.ImageDimension.width / 2, y: this.height / 2 - this.ImageDimension.height / 2 };\n  }\n  public AlignToGrid() {\n    this.AlignImageToCellBegin();\n    this.FitImageToGrid();\n  }\n  private AlignImageToCellBegin() {\n    this.ImageOffset = {\n      x: this.AlignedToNearVertice(this.imageState[StateComponent.X], StateComponent.X),\n      y: this.AlignedToNearVertice(this.imageState[StateComponent.Y], StateComponent.Y)\n    };\n  }\n\n  private AlignedToNearVertice(componentVal: number, componentType: StateComponent) {\n    const gridCellOffset = this.gridState[componentType] >= 0 ?\n      this.gridState[componentType] % this.gridState[2] :\n      this.gridState[2] - (-this.gridState[componentType] % this.gridState[2]);\n\n    const offsetFromCellBegin = (componentVal - gridCellOffset) % this.gridState[2];\n\n    const halfGridSize = this.gridState[2] / 2;\n\n    return componentVal + (offsetFromCellBegin < halfGridSize ? -offsetFromCellBegin : this.gridState[2] - offsetFromCellBegin)\n  }\n\n  private FitImageToGrid() {\n    const right = this.imageState[0] + this.ImageDimension.width;\n    const top = this.imageState[1] + this.ImageDimension.height;\n\n    let nearGridVerticeRight = this.AlignedToNearVertice(right, StateComponent.X);\n    let nearGridVerticeTop = this.AlignedToNearVertice(top, StateComponent.Y);\n\n    if (Math.abs(nearGridVerticeRight - this.imageState[0]) <= Number.EPSILON ||\n      Math.abs(nearGridVerticeTop - this.imageState[1]) <= Number.EPSILON) {\n      nearGridVerticeRight += this.gridState[2];\n      nearGridVerticeTop += this.gridState[2];\n    }\n\n    if (Math.abs(right - nearGridVerticeRight) < Math.abs(top - nearGridVerticeTop)) {\n      this.imageState[3] = (nearGridVerticeRight - this.imageState[0]) / this.imgRealDimension.width;\n    } else {\n      this.imageState[3] = (nearGridVerticeTop - this.imageState[1]) / this.imgRealDimension.height;\n    }\n  }\n  public Preview() {\n    DataUrlDownloader(this.view.canvas.toDataURL(), 'image.png');\n  }\n}\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[2]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./View.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[2]!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./View.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./View.vue?vue&type=template&id=7c65c3c4&scoped=true&\"\nimport script from \"./View.vue?vue&type=script&lang=ts&\"\nexport * from \"./View.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./View.vue?vue&type=style&index=0&id=7c65c3c4&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7c65c3c4\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c,_setup=_vm._self._setupProxy;return _c('canvas',{ref:\"canvas\",style:({ width: _vm.Width, height: _vm.Height })})\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","\nimport { Component, Emit, Prop, Ref, Vue, Watch } from 'vue-property-decorator';\n\n@Component\nexport default class Viewport extends Vue {\n  @Prop() public readonly width!: number;\n  @Prop() public readonly height!: number;\n  @Prop({ default: false }) public readonly preserveDrawingBuffer!: boolean;\n  @Ref() public readonly canvas!: HTMLCanvasElement;\n  @Emit('context-ready') public ContextReady(_ctx: WebGL2RenderingContext) { /** Nope */ }\n  private context: WebGL2RenderingContext | null = null;\n\n  public get Width() { return this.width + 'px' ?? '100%'; }\n  public get Height() { return this.height + 'px' ?? '100%'; }\n  public async mounted() {\n    this.context = this.canvas.getContext('webgl2', { preserveDrawingBuffer: this.preserveDrawingBuffer });\n    if (this.context === null) {\n      console.error('Can\\'t initialize webgl2 context');\n      return;\n    }\n    this.UpdateViewport();\n    this.context.enable(this.context.CULL_FACE);\n    this.context.enable(this.context.DEPTH_TEST);\n    this.ContextReady(this.context);\n  }\n  @Watch('width')\n  private OnWidth() {\n    this.UpdateViewport();\n  }\n  @Watch('height')\n  private OnHeight() {\n    this.UpdateViewport();\n  }\n  private UpdateViewport() {\n    this.canvas.width = this.width;\n    this.canvas.height = this.height;\n    this.context?.viewport(0, 0, this.width, this.height);\n  }\n}\n","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[2]!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Viewport.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??clonedRuleSet-41.use[2]!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./Viewport.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./Viewport.vue?vue&type=template&id=13fb0e92&scoped=true&\"\nimport script from \"./Viewport.vue?vue&type=script&lang=ts&\"\nexport * from \"./Viewport.vue?vue&type=script&lang=ts&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"13fb0e92\",\n  null\n  \n)\n\nexport default component.exports","export function Throw(msg: string): never {\n  throw new Error(msg);\n}\n","import { Throw } from '../misc/Throw';\n\nexport class ShaderProgram {\n  private uniformCache: Map<string, WebGLUniformLocation> = new Map();\n  protected instance: WebGLProgram;\n  public constructor(protected gl: WebGL2RenderingContext) {\n    if (!gl) throw new Error('Invalid webgl2 context');\n\n    this.instance = gl.createProgram() ?? Throw(\"Can't create shader program\");\n  }\n  public Attach(type: number, source: string) {\n    const shader = this.gl.createShader(type);\n    if (shader === null) throw new Error('Failed to create shader');\n\n    this.gl.shaderSource(shader, source);\n    this.gl.compileShader(shader);\n\n    if (!this.gl.getShaderParameter(shader, this.gl.COMPILE_STATUS)) {\n      const err = new Error(\n        this.gl.getShaderInfoLog(shader) ?? 'Failed to compile shader'\n      );\n      this.gl.deleteShader(shader);\n      throw err;\n    }\n\n    this.gl.attachShader(this.instance, shader);\n  }\n  public async AttachFromUrl(type: number, url: string) {\n    this.Attach(type, await (await fetch(url)).text());\n  }\n  public Link() {\n    this.gl.linkProgram(this.instance);\n    if (!this.gl.getProgramParameter(this.instance, this.gl.LINK_STATUS)) {\n      const err = new Error(\n        this.gl.getProgramParameter(this.instance, this.gl.LINK_STATUS) ??\n          'Failed to link shader'\n      );\n      this.gl.deleteProgram(this.instance);\n      throw err;\n    }\n  }\n  public Use() {\n    this.gl.useProgram(this.instance);\n  }\n  public SetUniform3fv(name: string, value: number[]) {\n    this.gl.uniform3fv(this.GetUniformLocation(name), value);\n  }\n  public SetUniform2fv(name: string, value: number[]) {\n    this.gl.uniform2fv(this.GetUniformLocation(name), value);\n  }\n  public SetUniform4fv(name: string, value: number[]) {\n    this.gl.uniform4fv(this.GetUniformLocation(name), value);\n  }\n  public SetUniform1f(name: string, value: number) {\n    this.gl.uniform1f(this.GetUniformLocation(name), value);\n  }\n  public SetUniform1i(name: string, value: number) {\n    this.gl.uniform1i(this.GetUniformLocation(name), value);\n  }\n  public SetUniform2iv(name: string, value: number[]) {\n    this.gl.uniform2iv(this.GetUniformLocation(name), value);\n  }\n  public GetAttributeLocation(name: string) {\n    this.Use();\n\n    const loc = this.gl.getAttribLocation(this.instance, name);\n\n    if (loc === -1) throw new Error(`Failed to locate attribute '${name}'`);\n\n    return loc;\n  }\n  private GetUniformLocation(name: string) {\n    this.Use();\n\n    let loc = this.uniformCache.get(name) ?? null;\n\n    if (loc === null) {\n      loc = this.gl.getUniformLocation(this.instance, name);\n\n      if (loc === null) throw new Error(`Failed to locate uniform '${name}'`);\n\n      this.uniformCache.set(name, loc);\n    }\n\n    return loc;\n  }\n}\n"],"names":["render","_vm","this","_c","_self","_setupProxy","staticClass","ref","attrs","width","height","on","OnContextReady","nativeOn","$event","preventDefault","OnWheel","deltaY","ctrlKey","altKey","OnMouseMove","buttons","movementX","movementY","stopPropagation","OnLoadImage","dataTransfer","files","apply","arguments","_v","_m","_s","gridState","GridScale","toFixed","imageState","ImageAngleDegrees","ImageScale","NoImage","CenterImage","Preview","AlignToGrid","staticRenderFns","Angle","static","degree","Math","PI","rad","a0","a1","b0","b1","a","X","Y","b","dotProduct","aMagnitude","sqrt","bMagnitude","acos","AcceleratedStepper","defaultStep","upperBound","acceleration","resetTimeout","step","prevActionTimestamp","constructor","Step","NeedAccelerate","Date","now","DataUrlDownloader","dataUrl","filename","document","createElement","href","download","click","async","EventWaiter","target","event","Promise","ok","addEventListener","once","StateComponent","Main","Vue","app","gl","vao","vbo","imgRealDimension","scroll","view","FillWindow","window","ShaderProgram","Attach","FRAGMENT_SHADER","FShader","VERTEX_SHADER","VShader","Link","Use","SetupBackground","SetupImage","disable","DEPTH_TEST","clearColor","clear","COLOR_BUFFER_BIT","SetUniform3fv","SetUniform4fv","bindVertexArray","requestAnimationFrame","Draw","beforeDestroy","console","log","ctx","background","createVertexArray","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","STATIC_DRAW","posLoc","GetAttributeLocation","SetUniform1i","enableVertexAttribArray","vertexAttribPointer","FLOAT","texture","createTexture","activeTexture","TEXTURE0","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","drawArrays","TRIANGLES","offset","ctrl","alt","OnImageScale","OnImageRotate","OnGridScale","btn","offsetX","offsetY","OnImageMove","OnGridMove","clip","ImageAngle","$set","ImageOffset","x","y","val","angle","ToDegrees","ImageDimension","OnGridUpdate","OnImageUpdate","blob","img","Image","src","URL","createObjectURL","AutoScale","texImage2D","RGBA","UNSIGNED_BYTE","innerWidth","innerHeight","AlignImageToCellBegin","FitImageToGrid","AlignedToNearVertice","componentVal","componentType","gridCellOffset","offsetFromCellBegin","halfGridSize","right","top","nearGridVerticeRight","nearGridVerticeTop","abs","Number","EPSILON","canvas","toDataURL","__decorate","Ref","Watch","Component","components","Viewport","component","style","Width","Height","preserveDrawingBuffer","ContextReady","_ctx","context","getContext","UpdateViewport","enable","CULL_FACE","error","OnWidth","OnHeight","viewport","Prop","default","Emit","Throw","msg","Error","uniformCache","Map","instance","createProgram","type","source","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","err","getShaderInfoLog","deleteShader","attachShader","url","fetch","text","linkProgram","getProgramParameter","LINK_STATUS","deleteProgram","useProgram","name","value","uniform3fv","GetUniformLocation","SetUniform2fv","uniform2fv","uniform4fv","SetUniform1f","uniform1f","uniform1i","SetUniform2iv","uniform2iv","loc","getAttribLocation","get","getUniformLocation","set"],"sourceRoot":""}